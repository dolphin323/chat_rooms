(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-469e7e5c"],{"00c4":function(e,t,a){},"36a0":function(e,t,a){"use strict";a("5d1e")},"36fd":function(e,t,a){"use strict";a("a721")},"487b":function(e,t,a){},"4a93":function(e,t,a){},"4dc5":function(e,t,a){e.exports=a.p+"img/star.cf856fb9.png"},"5d1e":function(e,t,a){},6144:function(e,t,a){"use strict";a("4a93")},"69eb":function(e,t,a){},"6e45":function(e,t,a){"use strict";a("d80c")},"794d":function(e,t,a){"use strict";a("00c4")},"9bc9":function(e,t,a){"use strict";a("487b")},a434:function(e,t,a){"use strict";var s=a("23e7"),n=a("23cb"),r=a("a691"),i=a("50c4"),o=a("7b0b"),c=a("65f0"),u=a("8418"),l=a("1dde"),m=l("splice"),d=Math.max,h=Math.min,_=9007199254740991,f="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!m},{splice:function(e,t){var a,s,l,m,p,v,b=o(this),C=i(b.length),g=n(e,C),w=arguments.length;if(0===w?a=s=0:1===w?(a=0,s=C-g):(a=w-2,s=h(d(r(t),0),C-g)),C+a-s>_)throw TypeError(f);for(l=c(b,s),m=0;m<s;m++)p=g+m,p in b&&u(l,m,b[p]);if(l.length=s,a<s){for(m=g;m<C-s;m++)p=m+s,v=m+a,p in b?b[v]=b[p]:delete b[v];for(m=C;m>C-s+a;m--)delete b[m-1]}else if(a>s)for(m=C-s;m>g;m--)p=m+s-1,v=m+a-1,p in b?b[v]=b[p]:delete b[v];for(m=0;m<a;m++)b[m+g]=arguments[m+2];return b.length=C-s+a,l}})},a721:function(e,t,a){},ac11:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ModalChangeRoomName",{directives:[{name:"show",rawName:"v-show",value:e.isModalVisible,expression:"isModalVisible"}],on:{close:e.closeModal}}),a("div",{staticClass:"chats_block"},[a("div",{staticClass:"chats"},[e.display_list?a("ChatList",{attrs:{rooms:e.rooms,user_id:e.me.id},on:{"chat-clicked":e.ChatInfoProps}}):e._e(),a("div",{ref:"infoBox",staticClass:"no_list"},[e.display_list?e._e():a("div",[a("div",{staticClass:"text-container",attrs:{id:"two"}},[a("span",{ref:"infoBoxText",class:e.width_box<=e.width_box_text?"animate":""},[e._v(e._s(e.current_room_name))]),a("div",{staticClass:"fader fader-left"}),a("div",{staticClass:"fader fader-right"})])]),a("div",{staticClass:"chat_buttons"},[e.display_list?e._e():a("div",{staticClass:"outer"},[a("button",{staticClass:"left_chat",on:{click:e.LeftChat}},[e._v("Left chat")])]),e.display_owner_buttons?a("div",{staticClass:"outer"},[a("button",{staticClass:"delete_chat",on:{click:e.DeleteChat}},[e._v(" Delete chat ")])]):e._e(),e.display_owner_buttons?a("div",{staticClass:"outer"},[a("button",{staticClass:"rename_chat btn",on:{click:e.showModal}},[e._v(" Rename chat ")])]):e._e()])]),e.display_chat?a("Chat",{attrs:{messages:e.messages,user_id:e.me.id}}):e._e(),e.display_chat?a("ChatInfo",{attrs:{members:e.members,owner:e.owner,user_id:e.me.id}}):e._e(),e.display_chat?e._e():a("div",{staticClass:"no_chat"},[a("span",[e._v("Choose chat")])])],1)])],1)},n=[],r=a("1da1"),i=(a("96cf"),a("159b"),a("a434"),a("b0c0"),a("d81d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chat_lists"},[e._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"search",attrs:{type:"text"},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}}),a("div",{staticClass:"chat_list"},e._l(e.rooms,(function(t){return a("div",{key:t.id},[t.name.includes(e.search)&&""!==e.search||""===e.search?a("ChatListElement",{attrs:{chat_name:t.name,chat_id:t.id,owner_id:t.owner.id,user_id:e.user_id},on:{"join-chat":e.JoinChat}}):e._e()],1)})),0)])}),o=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chat_h2"},[a("h2",[e._v("Chats")])])}],c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chat_list_element",on:{click:function(t){return e.$emit("join-chat",e.chat_id)}}},[s("div",{staticClass:"info"},[s("div",{staticClass:"chat_photo",style:"background-color: "+e.color},[e._v(" "+e._s(e.chat_name[0])+" ")]),s("span",[e._v(e._s(e.chat_name))])]),s("div",[e.user_id===e.owner_id?s("img",{attrs:{src:a("4dc5"),alt:"send Icon"}}):e._e()])])},u=[],l={name:"ChatListElement",props:["chat_name","chat_id","owner_id","user_id"],data:function(){return{active:!1,color:""}},created:function(){this.color="hsl("+360*Math.random()+","+(25+70*Math.random())+"%,"+(85+10*Math.random())+"%)"}},m=l,d=(a("36fd"),a("2877")),h=Object(d["a"])(m,c,u,!1,null,"419c4904",null),_=h.exports,f=a("546f"),p={name:"ChatList",props:["rooms","user_id"],data:function(){return{active:!1,search:""}},components:{ChatListElement:_},methods:{JoinChat:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$apollo.mutate({mutation:f["f"],variables:{id:e}});case 2:s=a.sent,t.$emit("chat-clicked",{data:s.data});case 4:case"end":return a.stop()}}),a)})))()}}},v=p,b=(a("f14c"),Object(d["a"])(v,i,o,!1,null,"f799e6ac",null)),C=b.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chat"},[a("div",{staticClass:"messages"},e._l(e.messages,(function(t){return a("div",{key:t.id},[a("ChatElement",{attrs:{mess:t.text,messTime:function(){return e.norm_date=new Date(t.timestamp),e.norm_date.getHours()+":"+e.norm_date.getMinutes()+":"+e.norm_date.getSeconds()+" "+e.norm_date.getDate()+"-"+(e.norm_date.getMonth()+1)}(),author:t.author,user_id:e.user_id}})],1)})),0),a("div",{staticClass:"wrap_input_mess"},[a("div",{staticClass:"input_mess"},[a("form",{staticClass:"send_mess",on:{submit:function(t){return t.preventDefault(),e.SendMessage(t)}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.message_text,expression:"message_text"}],staticClass:"form_control",attrs:{type:"text",placeholder:"Enter your message"},domProps:{value:e.message_text},on:{input:function(t){t.target.composing||(e.message_text=t.target.value)}}})])])])])},w=[],x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mess_wrap",class:e.user_id===e.author.id?"own_message":""},[a("div",{staticClass:"message"},[a("div",{staticClass:"author"},[e._v(e._s(e.author.username))]),a("div",{staticClass:"text"},[e._v(" "+e._s(e.mess)+" "),a("div",{staticClass:"time"},[e._v(e._s(e.messTime))])])])])},y=[],k={name:"ChatElement",props:["mess","author","messTime","user_id"]},R=k,$=(a("f05c"),Object(d["a"])(R,x,y,!1,null,"7025c9f6",null)),M=$.exports,q={name:"Chat",components:{ChatElement:M},props:["messages","user_id"],data:function(){return{message_text:"",me:{}}},apollo:{me:{fetchPolicy:"no-cache",query:f["q"]},$subscribe:{create_rooms:{query:f["l"],result:function(e){var t=e.data;this.messages.push(t.messageCreated)}}}},methods:{SendMessage:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.message_text){t.next=4;break}return t.next=3,e.$apollo.mutate({mutation:f["b"],variables:{message:e.message_text}});case 3:e.message_text="";case 4:case"end":return t.stop()}}),t)})))()}}},E=q,j=(a("36a0"),Object(d["a"])(E,g,w,!1,null,"04f73aa0",null)),O=j.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chat_info"},[a("h2",[e._v("Chat creator")]),a("ChatOwner",{attrs:{owner:e.owner,user_id:e.user_id}}),a("h2",[e._v("Chat members")]),a("div",{staticClass:"chat_members"},e._l(e.members,(function(t){return a("div",{key:t.id},[a("ChatMemberElement",{attrs:{member:t,user_id:e.user_id}})],1)})),0)],1)},P=[],L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chat_member"},[a("img",{attrs:{src:"https://static.toiimg.com/photo/72975551.cms",alt:"chat img"}}),a("span",[e._v(e._s(e.member.username)+" "+e._s(e.user_id===e.member.id?"(you)":""))])])},T=[],I={name:"ChatMemberElement",props:["member","user_id"]},B=I,N=(a("e894"),Object(d["a"])(B,L,T,!1,null,"028bbd52",null)),J=N.exports,V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"owner"},[s("span",{staticClass:"owner_name"},[s("img",{attrs:{src:"https://static.toiimg.com/photo/72975551.cms",alt:"chat img"}}),s("span",{staticClass:"text"},[e._v(e._s(e.owner.username)+" "+e._s(e.user_id===e.owner.id?"(you)":""))])]),s("img",{attrs:{src:a("4dc5"),alt:"send Icon"}})])},S=[],U={name:"ChatOwner",props:["owner","user_id"]},W=U,A=(a("794d"),Object(d["a"])(W,V,S,!1,null,"52a515b9",null)),F=A.exports,H={name:"ChatInfo",components:{ChatMemberElement:J,ChatOwner:F},props:["members","owner","user_id"]},z=H,G=(a("6144"),Object(d["a"])(z,D,P,!1,null,"aa268640",null)),K=G.exports,Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"modal-fade"}},[a("div",{staticClass:"modal-backdrop"},[a("div",{staticClass:"modal",attrs:{role:"dialog","aria-labelledby":"modalTitle","aria-describedby":"modalDescription"}},[a("header",{staticClass:"modal-header",attrs:{id:"modalTitle"}},[e._t("header",[e._v(" Rename chat "),a("button",{staticClass:"btn-close",attrs:{type:"button","aria-label":"Close modal"},on:{click:e.close}},[e._v(" x ")])])],2),a("section",{staticClass:"modal-body",attrs:{id:"modalDescription"}},[e._t("body",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.chat_name,expression:"chat_name"}],staticClass:"chat_name_input",attrs:{type:"text"},domProps:{value:e.chat_name},on:{input:function(t){t.target.composing||(e.chat_name=t.target.value)}}})])],2),a("footer",{staticClass:"modal-footer"},[e._t("footer",[a("button",{staticClass:"btn-green",attrs:{type:"button","aria-label":"Rename chat"},on:{click:e.RenameChat}},[e._v(" Rename chat ")]),a("button",{staticClass:"btn-green",attrs:{type:"button","aria-label":"Close modal"},on:{click:e.close}},[e._v(" Close ")])])],2)])])])},X=[],Y={name:"ModalRenameChat",data:function(){return{chat_name:"",rooms:[]}},methods:{close:function(){this.$emit("close")},RenameChat:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.chat_name){t.next=10;break}return t.next=3,e.$apollo.query({fetchPolicy:"no-cache",query:f["q"]});case 3:return a=t.sent,t.next=6,e.$apollo.mutate({mutation:f["p"],variables:{id:a.data.me.currentRoom.id,name:e.chat_name}});case 6:e.chat_name="",e.close(),t.next=11;break;case 10:console.log("Empty string");case 11:case"end":return t.stop()}}),t)})))()}}},Z=Y,ee=(a("9bc9"),Object(d["a"])(Z,Q,X,!1,null,"d125a6cc",null)),te=ee.exports,ae={name:"Chats",data:function(){return{messages:[],members:[],rooms:[],owner:"",me:{},display_chat:!1,display_list:!0,display_owner_buttons:!1,isModalVisible:!1,current_room_name:"",width_box:0,width_box_text:300}},apollo:{$subscribe:{create_rooms:{query:f["m"],result:function(e){var t=e.data;this.rooms.push(t.roomCreated)}},delete_room:{query:f["n"],result:function(e){var t=e.data,a=-1;this.rooms.forEach((function(e,s){return e.id===t.roomDeleted.id?a=s:""})),this.rooms.splice(a,1)}},rename_room:{query:f["o"],result:function(e){var t=e.data;t.roomUpdated.owner.id===this.me.id&&(this.current_room_name=t.roomUpdated.name);var a=this.rooms.map((function(e){return e.id===t.roomUpdated.id&&(e=t.roomUpdated),e}));this.rooms=a}},joined_room:{query:f["j"],result:function(e){var t=e.data;this.members.push(t.memberJoined)}},left_room:{query:f["k"],result:function(e){var t=e.data,a=-1;this.members.forEach((function(e,s){return e.id===t.memberLeft.id?a=s:""})),this.members.splice(a,1)}}}},components:{ChatList:C,Chat:O,ChatInfo:K,ModalChangeRoomName:te},updated:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.infoBoxText&&(e.width_box_text=e.$refs.infoBoxText.clientWidth);case 1:case"end":return t.stop()}}),t)})))()},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apollo.query({fetchPolicy:"no-cache",query:f["q"]});case 2:if(a=t.sent,!a.data.me.currentRoom){t.next=7;break}return t.next=6,e.OpenChat(a);case 6:e.width_box_text=e.$refs.infoBoxText.clientWidth;case 7:return t.next=9,e.$apollo.query({query:f["e"]});case 9:s=t.sent,e.rooms=s.data.rooms,e.me=a.data.me,e.width_box=e.$refs.infoBox.clientWidth;case 13:case"end":return t.stop()}}),t)})))()},methods:{showModal:function(){this.isModalVisible=!0},closeModal:function(){this.isModalVisible=!1},LeftChat:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apollo.mutate({mutation:f["g"]});case 2:e.display_chat=!1,e.display_list=!0,e.display_owner_buttons=!1;case 5:case"end":return t.stop()}}),t)})))()},DeleteChat:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apollo.query({fetchPolicy:"no-cache",query:f["q"]});case 2:return a=t.sent,t.next=5,e.$apollo.mutate({mutation:f["d"],variables:{id:a.data.me.currentRoom.id}});case 5:e.display_chat=!1,e.display_list=!0,e.display_owner_buttons=!1;case 8:case"end":return t.stop()}}),t)})))()},OpenChat:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$apollo.query({fetchPolicy:"no-cache",query:f["q"]});case 2:s=a.sent,t.ChangeData(s,e.data.me.currentRoom);case 4:case"end":return a.stop()}}),a)})))()},ChatInfoProps:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$apollo.query({fetchPolicy:"no-cache",query:f["q"]});case 2:s=a.sent,t.ChangeData(s,e.data.joinRoom);case 4:case"end":return a.stop()}}),a)})))()},ChangeData:function(e,t){this.current_room_name=t.name,this.messages=t.lastMessages,this.members=t.members,this.owner=t.owner,e.data.me.id===this.owner.id&&(this.display_owner_buttons=!0),this.display_chat=!0,this.display_list=!1}}},se=ae,ne=(a("6e45"),Object(d["a"])(se,s,n,!1,null,null,null));t["default"]=ne.exports},aee6:function(e,t,a){},b0c0:function(e,t,a){var s=a("83ab"),n=a("9bf2").f,r=Function.prototype,i=r.toString,o=/^\s*function ([^ (]*)/,c="name";s&&!(c in r)&&n(r,c,{configurable:!0,get:function(){try{return i.call(this).match(o)[1]}catch(e){return""}}})},d80c:function(e,t,a){},d81d:function(e,t,a){"use strict";var s=a("23e7"),n=a("b727").map,r=a("1dde"),i=r("map");s({target:"Array",proto:!0,forced:!i},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},e894:function(e,t,a){"use strict";a("69eb")},f05c:function(e,t,a){"use strict";a("aee6")},f14c:function(e,t,a){"use strict";a("fd74")},fd74:function(e,t,a){}}]);
//# sourceMappingURL=chunk-469e7e5c.392599fe.js.map